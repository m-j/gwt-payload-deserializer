package hr.ecs.gwt.util;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileOutputStream;
import java.io.OutputStreamWriter;
import java.io.Writer;

import com.google.gwt.user.server.rpc.RPC;
import com.google.gwt.user.server.rpc.RPCRequest;

public class PayloadDeserializer {
	private static Writer out;
	
	public static void main(String[] args) {
		try{
			if(args.length < 2){
				System.out.println("GWT Payload has to be sent as the first parameter and destination file path as the second!");
				return;
			}
			File file = new File(args[1]);
			out = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(file), "UTF-8"));
			
			String payload = args[0];
//			String payload = "5|0|47|http://192.168.105.139/ericsson-mhealth-mn-web-interface/emh/|97C4ECAB71FD06CAF1EED4DEAF352460|com.ericsson.mhealth.client.service.interfaces.IUserService|saveRequestForLocalAdmin|com.ericsson.mhealth.domain.Message|com.ericsson.mhealth.domain.Message/1431649882|com.ericsson.mhealth.domain.EMHUser/903541149|com.ericsson.mhealth.domain.Domain/185197158|java.util.HashSet/1594477813|java.lang.Long/4227064769|System Admin Domain|GMT+1|java.util.HashMap/962170901|java.lang.String/2004016611|patients|initialised|[B/3308590456|class|role|key|patientUnits|EMHUsers||Dummy|Doctor|56456456|$2a$10$1jFUqrq/abP7E7jw3w9fm.FdLpusVY1qoQ4RMKh4KgFzv9fxYwN2a|01445654|com.ericsson.mhealth.domain.Role/9086998|users|actionPermissions|idList|dummy|enterprisePatientMedicalEntries|medicalEntries|newEvents|lowerUsers|idenosSet|superUsers|readingmessages|sentMessages|zdrdjeSet|receivedMessages|Assign unit request|java.util.Date/1659716317|Assign unit type Cardio 12 basic to patient with patient ID 26.|java.lang.Boolean/476441737|1|2|3|4|1|5|6|0|0|7|0|0|0|0|0|0|8|9|0|0|10|1|0|11|9|0|9|0|12|10|2|0|13|3|14|15|13|4|14|16|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|14|18|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|14|19|17|50|-84|-19|0|5|116|0|43|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|68|111|109|97|105|110|46|112|97|116|105|101|110|116|115|14|20|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|1|14|21|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|54|-84|-19|0|5|116|0|47|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|68|111|109|97|105|110|46|112|97|116|105|101|110|116|85|110|105|116|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|1|14|22|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|50|-84|-19|0|5|116|0|43|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|68|111|109|97|105|110|46|69|77|72|85|115|101|114|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|1|23|0|9|0|24|0|0|10|2|0|9|0|0|0|25|9|0|9|0|26|9|0|27|9|0|28|9|0|9|0|29|9|0|25|25|10|3|0|25|9|0|10|0|0|13|2|14|30|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|45|-84|-19|0|5|116|0|38|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|82|111|108|101|46|117|115|101|114|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|3|14|31|13|4|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|57|-84|-19|0|5|116|0|50|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|82|111|108|101|46|97|99|116|105|111|110|80|101|114|109|105|115|115|105|111|110|115|14|32|0|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|3|9|0|9|0|0|0|12|0|33|10|0|0|1|9|0|13|11|14|34|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|74|-84|-19|0|5|116|0|67|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|101|110|116|101|114|112|114|105|115|101|80|97|116|105|101|110|116|77|101|100|105|99|97|108|69|110|116|114|105|101|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|14|35|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|57|-84|-19|0|5|116|0|50|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|109|101|100|105|99|97|108|69|110|116|114|105|101|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|14|36|13|4|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|52|-84|-19|0|5|116|0|45|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|110|101|119|69|118|101|110|116|115|-57|0|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|-10|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|51|-84|-19|0|5|116|0|44|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|112|97|116|105|101|110|116|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|14|37|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|53|-84|-19|0|5|116|0|46|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|108|111|119|101|114|85|115|101|114|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|14|38|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|52|-84|-19|0|5|116|0|45|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|105|100|101|110|111|115|83|101|116|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|14|39|13|4|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|53|-84|-19|0|5|116|0|46|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|115|117|112|101|114|85|115|101|114|115|-57|0|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|14|40|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|58|-84|-19|0|5|116|0|51|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|114|101|97|100|105|110|103|109|101|115|115|97|103|101|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|14|41|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|55|-84|-19|0|5|116|0|48|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|115|101|110|116|77|101|115|115|97|103|101|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|14|42|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|52|-84|-19|0|5|116|0|45|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|122|100|114|100|106|101|83|101|116|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|14|43|13|4|-12|17|47|-84|-19|0|5|115|114|0|17|106|97|118|97|46|108|97|110|103|46|66|111|111|108|101|97|110|-51|32|114|-128|-43|-100|-6|-18|2|0|1|90|0|5|118|97|108|117|101|120|112|0|-14|17|45|-84|-19|0|5|116|0|38|111|114|103|46|104|105|98|101|114|110|97|116|101|46|99|111|108|108|101|99|116|105|111|110|46|80|101|114|115|105|115|116|101|110|116|83|101|116|-16|17|59|-84|-19|0|5|116|0|52|99|111|109|46|101|114|105|99|115|115|111|110|46|109|104|101|97|108|116|104|46|100|111|109|97|105|110|46|69|77|72|85|115|101|114|46|114|101|99|101|105|118|101|100|77|101|115|115|97|103|101|115|-18|17|82|-84|-19|0|5|115|114|0|14|106|97|118|97|46|108|97|110|103|46|76|111|110|103|59|-117|-28|-112|-52|-113|35|-33|2|0|1|74|0|5|118|97|108|117|101|120|114|0|16|106|97|118|97|46|108|97|110|103|46|78|117|109|98|101|114|-122|-84|-107|29|11|-108|-32|-117|2|0|0|120|112|0|0|0|0|0|0|0|2|44|45|747350440|1305670057984|46|0|47|0|13|0|";
			EcsSerializationPolicyProvider provider = new EcsSerializationPolicyProvider(payload);

			@SuppressWarnings("unused")
			RPCRequest rpcRequest = RPC.decodeRequest(payload, provider.getClass(), provider);
//			Object[] params = rpcRequest.getParameters();
			
			out.close();
			
		}catch(Exception e){
			e.printStackTrace();
		}
		
	}
	
	public static void appendToFile(String str){
		try {
			out.write(str);
			System.out.print(str);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

}
